From 1580be98eff03d61477e5138b1ec0caf9ba64403 Mon Sep 17 00:00:00 2001
From: Tim Waugh <twaugh@redhat.com>
Date: Thu, 11 Sep 2014 12:22:21 +0100
Subject: More Python3 fixes.


diff --git a/newprinter.py b/newprinter.py
index fb9db8d..7bbb80d 100644
--- a/newprinter.py
+++ b/newprinter.py
@@ -1803,7 +1803,7 @@ class NewPrinterGUI(GtkGUI):
             return None
 
         faxtype = -1
-        for line in stdout.split ("\n"):
+        for line in stdout.decode ().split ("\n"):
             if line.find ("fax-type") == -1:
                 continue
             res = re.search ("(\d+)", line)
@@ -1834,7 +1834,7 @@ class NewPrinterGUI(GtkGUI):
             # Problem executing command.
             return None
 
-        scan_type = stdout.strip ()
+        scan_type = stdout.decode ().strip ()
         fields = scan_type.split ("=", 1)
         if len (fields) < 2:
             return None
@@ -1864,7 +1864,7 @@ class NewPrinterGUI(GtkGUI):
             # Problem executing command.
             return None
 
-        uri = stdout.strip ()
+        uri = stdout.decode ().strip ()
         return uri
 
     def getNetworkPrinterMakeModel(self, host=None, device=None):
@@ -1905,7 +1905,7 @@ class NewPrinterGUI(GtkGUI):
                 pass
 
             if stdout != None:
-                line = stdout.strip ()
+                line = stdout.decode ().strip ()
                 words = probe_printer.wordsep (line)
                 n = len (words)
                 if n < 4:
@@ -3874,7 +3874,7 @@ class NewPrinterGUI(GtkGUI):
                                           stdout=subprocess.PIPE,
                                           stderr=subprocess.PIPE)
                     (stdout, stderr) = p.communicate ()
-                    err += stdout
+                    err += stdout.decode ()
                 except:
                     # Problem executing command.
                     raise
diff --git a/probe_printer.py b/probe_printer.py
index 425c6cc..6c1a7a3 100644
--- a/probe_printer.py
+++ b/probe_printer.py
@@ -1,8 +1,8 @@
 ## system-config-printer
 
-## Copyright (C) 2006, 2007, 2008, 2009, 2010, 2011, 2012 Red Hat, Inc.
+## Copyright (C) 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2014 Red Hat, Inc.
 ## Copyright (C) 2006 Florian Festi <ffesti@redhat.com>
-## Copyright (C) 2007, 2008, 2009 Tim Waugh <twaugh@redhat.com>
+## Copyright (C) 2007, 2008, 2009, 2014 Tim Waugh <twaugh@redhat.com>
 
 ## This program is free software; you can redistribute it and/or modify
 ## it under the terms of the GNU General Public License as published by
@@ -297,7 +297,7 @@ class PrinterFinder:
             debugprint ("snmp: no good")
             return
 
-        for line in stdout.decode('utf-8').split ('\n'):
+        for line in stdout.decode ().split ('\n'):
             words = wordsep (line)
             n = len (words)
             if n == 6:
@@ -388,7 +388,7 @@ class PrinterFinder:
             debugprint ("hplip: no good")
             return
 
-        uri = stdout.strip ()
+        uri = stdout.decode ().strip ()
         debugprint ("hplip: uri is %s" % uri)
         if uri.find (":") != -1:
             self._new_device(uri, uri)
diff --git a/userdefault.py b/userdefault.py
index 8ceaefc..204b964 100644
--- a/userdefault.py
+++ b/userdefault.py
@@ -1,6 +1,6 @@
 #!/usr/bin/python3
 
-## Copyright (C) 2006, 2007, 2008, 2010, 2012 Red Hat, Inc.
+## Copyright (C) 2006, 2007, 2008, 2010, 2012, 2014 Red Hat, Inc.
 ## Author: Tim Waugh <twaugh@redhat.com>
 
 ## This program is free software; you can redistribute it and/or modify
@@ -81,7 +81,7 @@ class UserDefaultPrinter:
         (stdout, stderr) = p.communicate ()
         exitcode = p.wait ()
         if exitcode != 0:
-            raise RuntimeError (exitcode, stderr.strip ())
+            raise RuntimeError (exitcode, stderr.decode ().strip ())
         return
 
     def __repr__ (self):
-- 
cgit v0.10.2

